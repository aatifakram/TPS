<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Tapowan Public School - Login / Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <!-- Chart.js for dashboard charts (removed from reports module) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- html5-qrcode for QR scanning -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/dist/html5-qrcode.min.js"></script>
    <!-- QRious for QR code generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<!-- Login UI -->
<div id="login-ui">
    <div class="login-container">
        <div class="login-header">
            <img alt="SchoolPulse Logo" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e9554fd1-c066-4325-a649-08e555ad308c.png"/>
            <h1>Tapowan Public School</h1>
            <p class="text-sm" style="color: var(--gray-medium);" id="typed-welcome"></p>
            <p style="color: var(--gray-medium);" class="mt-2">Sign in to your account</p>
        </div>
        <div class="role-selection">
            <button class="role-button active" data-role="admin" type="button">
                <i class="fas fa-user-shield"></i>
                <span>Admin</span>
            </button>
            <button class="role-button" data-role="teacher" type="button">
                <i class="fas fa-chalkboard-teacher"></i>
                <span>Teacher</span>
            </button>
            <button class="role-button" data-role="student" type="button">
                <i class="fas fa-user-graduate"></i>
                <span>Student</span>
            </button>
        </div>
        <form id="loginForm">
            <input id="selectedRole" name="role" type="hidden" value="admin"/>
            <div class="form-group">
                <label for="email">Username</label>
                <input id="email" name="email" placeholder="mdtfansari@gmail.com" required="" type="email"/>
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input id="password" name="password" placeholder="12345678" required="" type="password"/>
            </div>
            <div class="flex justify-between items-center mt-4">
                <button class="login-button" type="submit">Login</button>
                <button class="login-button" type="button" id="signUpButton" style="background-color: var(--primary); margin-left: 1rem;">Sign Up</button>
            </div>
            <button class="mt-4 rounded-full p-2" type="button" onclick="startVoiceAssistant()" style="background-color: var(--primary); color: white;">
                <i class="fas fa-microphone"></i>
            </button>
        </form>
        <div class="forgot-password">
            <a href="#" id="forgotPasswordLink">Forgot Password?</a>
        </div>
    </div>
</div>
<!-- Forgot Password Modal -->
<div class="modal-overlay" id="forgotPasswordModal" aria-labelledby="forgotPasswordTitle" aria-modal="true" role="dialog" tabindex="-1">
    <div class="modal-content">
        <button class="modal-close-button" id="closeForgotPasswordModal" type="button" aria-label="Close forgot password modal">×</button>
        <h2 id="forgotPasswordTitle">Forgot Password</h2>
        <p>Enter your email address below and we'll send you a link to reset your password.</p>
        <form id="forgotPasswordForm">
            <div class="form-group">
                <label for="forgotEmail">Email Address</label>
                <input id="forgotEmail" name="forgotEmail" placeholder="your.email@example.com" required="" type="email"/>
            </div>
            <button class="login-button" type="submit">Send Reset Link</button>
        </form>
    </div>
</div>

<!-- Sign Up Modal -->
<div class="modal-overlay" id="signUpModal" aria-labelledby="signUpModalTitle" aria-modal="true" role="dialog" tabindex="-1">
    <div class="modal-content">
        <button class="modal-close-button" id="closeSignUpModal" type="button" aria-label="Close sign up modal">×</button>
        <h2 id="signUpModalTitle">Sign Up for an Account</h2>
        <form id="signUpForm">
            <div class="form-group">
                <label for="signUpFullName">Full Name</label>
                <input id="signUpFullName" name="signUpFullName" placeholder="John Doe" required="" type="text"/>
            </div>
            <div class="form-group">
                <label for="signUpEmail">Email</label>
                <input id="signUpEmail" name="signUpEmail" placeholder="your.email@example.com" required="" type="email"/>
            </div>
            <div class="form-group">
                <label for="signUpPassword">Password</label>
                <input id="signUpPassword" name="signUpPassword" placeholder="********" required="" type="password"/>
            </div>
            <div class="form-group">
                <label for="signUpRole">Role</label>
                <select id="signUpRole" name="signUpRole" required="">
                    <option value="">Select Role</option>
                    <option value="admin">Admin</option>
                    <option value="teacher">Teacher</option>
                    <option value="student">Student</option>
                    <option value="staff">Staff</option>
                </select>
            </div>
            <button class="login-button" type="submit" style="background-color: var(--primary);">Create Account</button>
        </form>
    </div>
</div>

<!-- School Site UI -->
<div id="school-site-ui" class="hidden">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar w-64 shadow-md flex flex-col animate-slideInFromLeft">
            <!-- Logo -->
            <div class="logo-section flex items-center space-x-3">
                <img alt="SchoolPulse Logo" class="rounded-lg animate-popIn" src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e9554fd1-c066-4325-a649-08e555ad308c.png"/>
                <h1 class="font-bold animate-fadeIn" style="animation-delay: 0.2s;">Tapowan Public School</h1>
            </div>
            <!-- Navigation -->
            <nav class="flex-1 overflow-y-auto">
                <div class="space-y-1 nav-section">
                    <h3 class="uppercase font-medium animate-fadeIn" style="animation-delay: 0.3s;">MAIN MENU</h3>
                    <a class="nav-item active animate-slideInFromLeft" data-module="dashboard" href="#" style="animation-delay: 0.4s;">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </div>
                <div class="space-y-1 mt-6 nav-section">
                    <h3 class="uppercase font-medium animate-fadeIn" style="animation-delay: 0.6s;">MODULES</h3>
                    <a class="nav-item animate-slideInFromLeft" data-module="students" href="#students" style="animation-delay: 0.7s;">
                        <i class="fas fa-user-graduate"></i>
                        <span>Students</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="teachers" href="#teachers" style="animation-delay: 0.8s;">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <span>Teachers</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="payroll" href="#payroll" style="animation-delay: 0.9s;">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>Payroll</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="finance" href="#finance" style="animation-delay: 1.0s;">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <span>Finance</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="attendance" href="#attendance" style="animation-delay: 1.05s;">
                        <i class="fas fa-check-circle"></i>
                        <span>Attendance</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="teacher-attendance" href="#teacher-attendance" style="animation-delay: 1.15s;">
                        <i class="fas fa-user-check"></i>
                        <span>Teacher Attendance</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="calendar" href="#calendar" style="animation-delay: 1.1s;">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Calendar</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="reports" href="#reports" style="animation-delay: 1.2s;">
                        <i class="fas fa-chart-line"></i>
                        <span>Reports</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="exams" href="#exams" style="animation-delay: 1.25s;">
                        <i class="fas fa-file-alt"></i>
                        <span>Exams</span>
                    </a>
                    <!-- NEW: Homework Module Link -->
                    <a class="nav-item animate-slideInFromLeft" data-module="homework" href="#homework" style="animation-delay: 1.3s;">
                        <i class="fas fa-book"></i>
                        <span>Homework</span>
                    </a>
                </div>
                <div class="space-y-1 mt-6 nav-section">
                    <h3 class="uppercase font-medium animate-fadeIn" style="animation-delay: 1.3s;">ADMIN</h3>
                    <a class="nav-item animate-slideInFromLeft" data-module="user-management" href="#user-management" style="animation-delay: 1.4s;">
                        <i class="fas fa-users-cog"></i>
                        <span>User Management</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="roles-permissions" href="#roles-permissions" style="animation-delay: 1.5s;">
                        <i class="fas fa-user-shield"></i>
                        <span>Roles &amp; Permissions</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="system-settings" href="#system-settings" style="animation-delay: 1.6s;">
                        <i class="fas fa-cogs"></i>
                        <span>System Settings</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="audit-logs" href="#audit-logs" style="animation-delay: 1.7s;">
                        <i class="fas fa-clipboard-list"></i>
                        <span>Audit Logs</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="backup-restore" href="#backup-restore" style="animation-delay: 1.8s;">
                        <i class="fas fa-database"></i>
                        <span>Backup &amp; Restore</span>
                    </a>
                    <a class="nav-item animate-slideInFromLeft" data-module="announcements" href="#announcements" style="animation-delay: 1.9s;">
                        <i class="fas fa-bullhorn"></i>
                        <span>Announcements</span>
                    </a>
                </div>
            </nav>
        </div>
        <!-- Main Content -->
        <div class="flex-1 overflow-auto">
            <!-- Top Bar -->
            <header class="shadow-sm flex justify-between items-center relative animate-slideInFromTop">
                <h2 id="currentModuleTitle">Dashboard</h2>
                <div class="flex items-center space-x-4">
                    <button class="p-2 rounded-full hover:bg-gray-100 relative" id="notificationButton" type="button" aria-label="Show notifications">
                        <i class="fas fa-bell" style="color: var(--gray-medium);"></i>
                        <span class="absolute top-0 right-0 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-bold leading-none text-white rounded-full" style="background-color: var(--accent);" id="notificationCount">3</span>
                    </button>
                    <!-- NEW: Dark Mode Toggle -->
                    <button class="p-2 rounded-full hover:bg-gray-100" id="darkModeToggle" type="button" aria-label="Toggle dark mode">
                        <i class="fas fa-moon" style="color: var(--gray-medium);"></i> <!-- Moon icon for light mode -->
                    </button>
                    <!-- Notification Dropdown UI -->
                    <div class="notification-dropdown hidden" id="notificationDropdown">
                        <div class="header flex justify-between items-center">
                            <h4>Notifications</h4>
                            <span class="text-sm" style="color: var(--gray-medium);" id="newCount">3 New</span>
                        </div>
                        <div class="notification-list" id="notificationList">
                            <!-- Notifications will be inserted here dynamically -->
                        </div>
                        <div class="notification-footer">
                            <button id="markAllReadBtn" type="button">Mark all as read</button>
                            <a href="#" id="viewAllNotificationsLink">View all</a>
                        </div>
                    </div>
                    <!-- End Notification Dropdown UI -->
                    <div class="relative"> <!-- Added relative positioning for the dropdown -->
                        <div class="flex items-center space-x-2 cursor-pointer p-2 rounded-md hover:bg-gray-100" id="userProfileToggle">
                            <span id="loggedInUserName" style="color: var(--dark);" class="font-medium">Admin</span>
                            <i class="fas fa-chevron-down text-xs" style="color: var(--gray-medium);"></i>
                        </div>
                        <!-- User Dropdown UI -->
                        <div class="user-dropdown hidden absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 z-20" id="userDropdown">
                            <div class="user-dropdown-item px-4 py-2 text-sm hover:bg-gray-100 cursor-pointer" id="logoutButton">
                                <i class="fas fa-sign-out-alt mr-2"></i>
                                <span>Logout</span>
                            </div>
                        </div>
                        <!-- End User Dropdown UI -->
                    </div>
                </div>
            </header>
            <!-- Dashboard Content -->
            <main class="p-6 animate-fadeIn" id="dashboardMainContent" style="animation-delay: 0.5s;" onload="initCharts()">
                <!-- Module Tabs -->
                <div class="tabs mb-6" id="moduleTabs">
                    <button class="tab" data-tab="dashboard" type="button">Dashboard</button>
                    <button class="tab" data-tab="students" type="button">Students</button>
                    <button class="tab" data-tab="teachers" type="button">Teachers</button>
                    <button class="tab" data-tab="payroll" type="button">Payroll</button>
                    <button class="tab" data-tab="finance" type="button">Finance</button>
                    <button class="tab" data-tab="attendance" type="button">Attendance</button>
                    <button class="tab" data-tab="teacher-attendance" type="button">Teacher Attendance</button>
                    <button class="tab" data-tab="calendar" type="button">Calendar</button>
                    <button class="tab" data-tab="reports" type="button">Reports</button>
                    <button class="tab" data-tab="exams" type="button">Exams</button>
                    <!-- NEW: Homework Tab -->
                    <button class="tab" data-tab="homework" type="button">Homework</button>
                    <button class="tab" data-tab="user-management" type="button">User Management</button>
                    <button class="tab" data-tab="roles-permissions" type="button">Roles &amp; Permissions</button>
                    <button class="tab" data-tab="system-settings" type="button">System Settings</button>
                    <button class="tab" data-tab="audit-logs" type="button">Audit Logs</button>
                    <button class="tab" data-tab="backup-restore" type="button">Backup &amp; Restore</button>
                    <button class="tab" data-tab="announcements" type="button">Announcements</button>
                </div>
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 0.6s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);">Total Students</p>
                                <h3 class="text-2xl font-bold mt-1" id="totalStudentsCount">0</h3>
                            </div>
                            <div class="icon-wrapper bg-blue-50 text-blue-600">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                        </div>
                    </div>
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 0.7s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);">Total Teachers</p>
                                <h3 class="text-2xl font-bold mt-1" id="totalTeachersCount">0</h3>
                            </div>
                            <div class="icon-wrapper bg-green-50 text-green-600">
                                <i class="fas fa-chalkboard-teacher"></i>
                            </div>
                        </div>
                    </div>
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 0.8s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);" id="studentsPresentLabel">Students Present Today</p>
                                <h3 class="text-2xl font-bold mt-1" id="studentsPresentToday">0</h3>
                                <div id="holidayIndicator" class="text-xs hidden" style="color: var(--primary);">Today is a holiday</div>
                            </div>
                            <div class="icon-wrapper bg-indigo-50 text-indigo-600">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 0.9s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);">Teachers Present Today</p>
                                <h3 class="text-2xl font-bold mt-1" id="teachersPresentToday">0</h3>
                            </div>
                            <div class="icon-wrapper bg-teal-50 text-teal-600">
                                <i class="fas fa-user-check"></i>
                            </div>
                        </div>
                    </div>
                    <!-- Added for monthly revenue and upcoming events -->
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 0.95s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);">Monthly Revenue</p>
                                <h3 class="text-2xl font-bold mt-1" id="monthlyRevenue">₹0.00</h3>
                            </div>
                            <div class="icon-wrapper bg-purple-50 text-purple-600">
                                <i class="fas fa-wallet"></i>
                            </div>
                        </div>
                    </div>
                    <div class="module-card p-6 animate-popIn" style="animation-delay: 1.0s;">
                        <div class="flex justify-between items-start">
                            <div>
                                <p style="color: var(--gray-medium);">Upcoming Events</p>
                                <h3 class="text-2xl font-bold mt-1" id="upcomingEventsCount">0</h3>
                            </div>
                            <div class="icon-wrapper bg-orange-50 text-orange-600">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Modules Section -->
                <div class="module-card p-6 mb-8 animate-fadeIn" style="animation-delay: 1.3s;">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold">Quick Access Modules</h3>
                        <button style="color: var(--primary);" class="hover:text-blue-800" data-module="students" type="button">View All</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Students Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.4s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-blue-50 text-blue-600">
                                    <i class="fas fa-user-graduate"></i>
                                </div>
                                <h4 class="font-medium">Students</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Manage student records, attendance, and performance</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="students" type="button">Open Module</button>
                        </div>
                        <!-- Teachers Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.5s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-green-50 text-green-600">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                </div>
                                <h4 class="font-medium">Teachers</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Manage faculty information and class assignments</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="teachers" type="button">Open Module</button>
                        </div>
                        <!-- Payroll Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.6s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-yellow-50 text-yellow-600">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <h4 class="font-medium">Payroll</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Process salaries and manage staff payments</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="payroll" type="button">Open Module</button>
                        </div>
                        <!-- Finance Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.7s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-purple-50 text-purple-600">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                </div>
                                <h4 class="font-medium">Finance</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Generate invoices and manage school finances</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="finance" type="button">Open Module</button>
                        </div>
                        <!-- Attendance Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.75s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-indigo-50 text-indigo-600">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <h4 class="font-medium">Attendance</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Track and manage student attendance records</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="attendance" type="button">Open Module</button>
                        </div>
                        <!-- Calendar Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.8s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-red-50 text-red-600">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <h4 class="font-medium">Calendar</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">View and manage school events and schedules</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="calendar" type="button">Open Module</button>
                        </div>
                        <!-- Reports Module -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 1.9s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-indigo-50 text-indigo-600">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <h4 class="font-medium">Reports</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Generate insights and analytics</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="reports" type="button">Open Module</button>
                        </div>
                        <!-- NEW: Homework Module Quick Access -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.0s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-blue-50 text-blue-600">
                                    <i class="fas fa-book"></i>
                                </div>
                                <h4 class="font-medium">Homework</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Assign and track homework for students</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="homework" type="button">Open Module</button>
                        </div>
                    </div>
                </div>
                <!-- Admin Options Section -->
                <div class="module-card p-6 mb-8 animate-fadeIn" style="animation-delay: 2.0s;">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-lg font-semibold">Admin Options</h3>
                        <button style="color: var(--primary);" class="hover:text-blue-800" data-module="user-management" type="button">View All</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- User Management -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.1s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-red-50 text-red-600">
                                    <i class="fas fa-users-cog"></i>
                                </div>
                                <h4 class="font-medium">User Management</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Add, edit, or remove user accounts</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="user-management" type="button">Open Module</button>
                        </div>
                        <!-- Role & Permissions -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.2s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-orange-50 text-orange-600">
                                    <i class="fas fa-user-shield"></i>
                                </div>
                                <h4 class="font-medium">Role &amp; Permissions</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Define and assign user roles and access rights</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="roles-permissions" type="button">Open Module</button>
                        </div>
                        <!-- System Settings -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.3s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-green-50 text-green-600">
                                    <i class="fas fa-cogs"></i>
                                </div>
                                <h4 class="font-medium">System Settings</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Configure general application settings</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="system-settings" type="button">Open Module</button>
                        </div>
                        <!-- Audit Logs -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.4s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-blue-50 text-blue-600">
                                    <i class="fas fa-clipboard-list"></i>
                                </div>
                                <h4 class="font-medium">Audit Logs</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Review system activity and user actions</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="audit-logs" type="button">Open Module</button>
                        </div>
                        <!-- Backup & Restore -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.5s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-purple-50 text-purple-600">
                                    <i class="fas fa-database"></i>
                                </div>
                                <h4 class="font-medium">Backup &amp; Restore</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Manage database backups and restoration</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="backup-restore" type="button">Open Module</button>
                        </div>
                        <!-- Announcements -->
                        <div class="module-card p-4 animate-popIn" style="animation-delay: 2.6s;">
                            <div class="flex items-center space-x-4 mb-3">
                                <div class="icon-wrapper bg-pink-50 text-pink-600">
                                    <i class="fas fa-bullhorn"></i>
                                </div>
                                <h4 class="font-medium">Announcements</h4>
                            </div>
                            <p style="color: var(--gray-medium);" class="text-sm mb-3">Create and manage school-wide announcements</p>
                            <button style="color: var(--primary);" class="text-sm font-medium open-module" data-module="announcements" type="button">Open Module</button>
                        </div>
                    </div>
                </div>
                <!-- Recent Activity and Calendar -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Recent Activity -->
                    <div class="module-card p-6 animate-fadeIn" style="animation-delay: 2.7s;">
                        <h3 class="text-lg font-semibold mb-4">Recent Activity</h3>
                        <div class="space-y-4" id="recentActivityList">
                            <!-- Activities will be dynamically loaded here -->
                        </div>
                    </div>
                    <!-- Calendar -->
                    <div class="module-card p-6 animate-fadeIn" style="animation-delay: 2.8s;">
                        <h3 class="text-lg font-semibold mb-4">School Calendar</h3>
                        <div class="min-h-[400px] fc-theme-standard" id="dashboardCalendar"></div>
                    </div>
                </div>
            </main>
            <!-- Module Containers -->
            <div class="hidden" id="modulesContainer">
                <!-- Dashboard Module (kept hidden as per original, JS will show it) -->
                <div id="dashboardModule" class="module-content hidden">
                    <!-- Dashboard content is already in main#dashboardMainContent, this div is just a placeholder for the JS logic -->
                </div>
                <!-- User Management Module -->
                <div class="module-content p-6 hidden" id="user-managementModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">User Management</h3>
                        <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="showAddUserForm()">
                            <i class="fas fa-plus mr-2"></i>Add User
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">ID</th>
                                    <th class="text-left py-3 px-4">Name</th>
                                    <th class="text-left py-3 px-4">Email</th>
                                    <th class="text-left py-3 px-4">Role</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="userTableBody">
                                <!-- Users will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Role & Permissions Module -->
                <div class="module-content p-6 hidden" id="roles-permissionsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Role &amp; Permissions Management</h3>
                        <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-orange-700" type="button" onclick="alert('Add New Role functionality goes here!')">
                            <i class="fas fa-plus mr-2"></i>Add New Role
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Role Name</th>
                                    <th class="text-left py-3 px-4">Description</th>
                                    <th class="text-left py-3 px-4">Permissions</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-3 px-4">Admin</td>
                                    <td class="py-3 px-4">Full access to all modules and settings.</td>
                                    <td class="py-3 px-4">All</td>
                                    <td class="py-3 px-4">
                                        <button class="text-blue-600 hover:text-blue-800 mr-3" title="Edit Role" type="button">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="text-purple-600 hover:text-purple-800" title="Manage Permissions" type="button">
                                            <i class="fas fa-user-shield"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-3 px-4">Teacher</td>
                                    <td class="py-3 px-4">Manage students, grades, and attendance for assigned classes.</td>
                                    <td class="py-3 px-4">Students, Calendar, Reports</td>
                                    <td class="py-3 px-4">
                                        <button class="text-blue-600 hover:text-blue-800 mr-3" title="Edit Role" type="button">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="text-purple-600 hover:text-purple-800" title="Manage Permissions" type="button">
                                            <i class="fas fa-user-shield"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-3 px-4">Student</td>
                                    <td class="py-3 px-4">View personal profile, grades, and school calendar.</td>
                                    <td class="py-3 px-4">Profile, Calendar</td>
                                    <td class="py-3 px-4">
                                        <button class="text-blue-600 hover:text-blue-800 mr-3" title="Edit Role" type="button">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="text-purple-600 hover:text-purple-800" title="Manage Permissions" type="button">
                                            <i class="fas fa-user-shield"></i>
                                        </button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- System Settings Module -->
                <div class="module-content p-6 hidden" id="system-settingsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">System Settings</h3>
                        <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" form="systemSettingsForm" type="submit">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <form class="space-y-6" id="systemSettingsForm">
                            <h4 class="text-lg font-medium" style="color: var(--dark);">General Settings</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="schoolName">School Name</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="schoolName" name="schoolName" required="" type="text" value="Tapowan Public School"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="schoolAddress">School Address</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="schoolAddress" name="schoolAddress" required="" type="text" value="123 Education Lane, School City"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="contactEmail">Contact Email</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="contactEmail" name="contactEmail" required="" type="email" value="info@tps.com"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="contactPhone">Contact Phone</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="contactPhone" name="contactPhone" type="tel" value="+1 (555) 123-4567"/>
                                </div>
                            </div>
                            <h4 class="text-lg font-medium mt-8" style="color: var(--dark);">Email Settings</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="smtpHost">SMTP Host</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="smtpHost" name="smtpHost" type="text" value="smtp.example.com"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="smtpPort">SMTP Port</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="smtpPort" name="smtpPort" type="number" value="587"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="smtpUsername">SMTP Username</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="smtpUsername" name="smtpUsername" type="text" value="noreply@schoolpulse.com"/>
                                </div>
                                <div>
                                    <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="smtpPassword">SMTP Password</label>
                                    <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="smtpPassword" name="smtpPassword" type="password" value="********"/>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Audit Logs Module -->
                <div class="module-content p-6 hidden" id="audit-logsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Audit Logs</h3>
                        <div class="flex items-center space-x-4">
                            <input class="p-2 border rounded-lg" style="border-color: var(--border-color);" type="date" name="auditLogStartDate"/>
                            <input class="p-2 border rounded-lg" style="border-color: var(--border-color);" type="date" name="auditLogEndDate"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Timestamp</th>
                                    <th class="text-left py-3 px-4">User</th>
                                    <th class="text-left py-3 px-4">Action</th>
                                    <th class="text-left py-3 px-4">Module</th>
                                    <th class="text-left py-3 px-4">Details</th>
                                </tr>
                                </thead>
                                <tbody id="auditLogTableBody">
                                <!-- Audit logs will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Backup & Restore Module -->
                <div class="module-content p-6 hidden" id="backup-restoreModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Backup &amp; Restore</h3>
                        <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-700" type="button" onclick="alert('Initiating database backup...')">
                            <i class="fas fa-database mr-2"></i>Create New Backup
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Backup History</h4>
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Backup ID</th>
                                    <th class="text-left py-3 px-4">Date</th>
                                    <th class="text-left py-3 px-4">Size</th>
                                    <th class="text-left py-3 px-4">Type</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="backupTableBody">
                                <!-- Backups will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Manual Restore</h4>
                        <div class="flex items-center space-x-4">
                            <input accept=".sql,.zip" class="block w-full text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-gray-50 file:text-gray-700 hover:file:bg-gray-100" type="file" name="restoreFile" style="color: var(--gray-medium);">
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="alert('Initiating manual restore...')">
                                <i class="fas fa-upload mr-2"></i>Upload &amp; Restore
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Announcements Module -->
                <div class="module-content p-6 hidden" id="announcementsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Announcements</h3>
                        <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-pink-700" type="button" onclick="showAddAnnouncementModal()">
                            <i class="fas fa-plus mr-2"></i>Add New Announcement
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Title</th>
                                    <th class="text-left py-3 px-4">Content</th>
                                    <th class="text-left py-3 px-4">Date Posted</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="announcementTableBody">
                                <!-- Announcements will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Students Module -->
                <div class="module-content p-6 hidden" id="studentsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Students Management</h3>
                        <div class="flex space-x-2"> <!-- Added a flex container for buttons -->
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="showAddStudentForm()">
                                <i class="fas fa-plus mr-2"></i>Add Student
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="exportStudentsToExcel()">
                                <i class="fas fa-file-excel mr-2"></i>Export to Excel
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchStudentName" placeholder="Search by Name" type="text" name="searchStudentName"/>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchRoll" placeholder="Search by Roll No." type="text" name="searchRoll"/>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchClass" name="searchClass">
                                <option value="">All Classes</option>
                                <option value="1">Grade 1</option>
                                <option value="2">Grade 2</option>
                                <option value="3">Grade 3</option>
                                <option value="4">Grade 4</option>
                                <option value="5">Grade 5</option>
                                <option value="6">Grade 6</option>
                                <option value="7">Grade 7</option>
                                <option value="8">Grade 8</option>
                                <option value="9">Grade 9</option>
                                <option value="10">Grade 10</option>
                                <option value="11">Grade 11</option>
                                <option value="12">Grade 12</option>
                            </select>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-600 w-full md:w-auto" id="applyStudentSearch" type="button">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full" id="studentsTable"> <!-- Added ID for easy access -->
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">ID</th>
                                    <th class="text-left py-3 px-4">Name</th>
                                    <th class="text-left py-3 px-4">Father's Name</th>
                                    <th class="text-left py-3 px-4">Mother's Name</th>
                                    <th class="text-left py-3 px-4">Class</th>
                                    <th class="text-left py-3 px-4">Roll No.</th>
                                    <th class="text-left py-3 px-4">Aadhar No.</th>
                                    <th class="text-left py-3 px-4">Blood Group</th>
                                    <th class="text-left py-3 px-4">Admission No.</th>
                                    <th class="text-left py-3 px-4">Admission Date</th>
                                    <th class="text-left py-3 px-4">Father's Aadhar</th>
                                    <th class="text-left py-3 px-4">Mother's Aadhar</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="studentTableBody">
                                <!-- Students will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Teachers Module -->
                <div class="module-content p-6 hidden" id="teachersModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Teachers Management</h3>
                        <div class="flex space-x-2"> <!-- Added a flex container for buttons -->
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="showAddTeacherForm()">
                                <i class="fas fa-plus mr-2"></i>Add Teacher
                            </button>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="exportTeachersToExcel()">
                                <i class="fas fa-file-excel mr-2"></i>Export to Excel
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="searchTeacherName" placeholder="Search by Name" type="text" name="searchTeacherName"/>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--secondary);" id="searchTeacherSubject" name="searchTeacherSubject">
                                <option value="">All Subjects</option>
                                <option>English</option>
                                <option>Hindi</option>
                                <option>Science</option>
                                <option>Math</option>
                                <option>Computer</option>
                                <option>Sanskrit</option>
                                <option>Social Study</option>
                                <option>Soil Science</option>
                            </select>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-600 w-full md:w-auto" id="applyTeacherSearch" type="button">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full" id="teachersTable"> <!-- Added ID for easy access -->
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">ID</th>
                                    <th class="text-left py-3 px-4">Name</th>
                                    <th class="text-left py-3 px-4">Subject</th>
                                    <th class="text-left py-3 px-4">Classes</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="teacherTableBody">
                                <!-- Teachers will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Payroll Module -->
                <div class="module-content p-6 hidden" id="payrollModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Payroll Management</h3>
                        <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-orange-600 flex items-center space-x-2" id="openPayrollModalBtn" type="button">
                            <i class="fas fa-plus"></i>
                            <span>Process Payroll</span>
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--accent);" id="searchPayrollPeriod" placeholder="Search by Period (e.g., October 2023)" type="text" name="searchPayrollPeriod"/>
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-orange-600 w-full md:w-auto" id="applyPayrollSearch" type="button">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Period</th>
                                    <th class="text-left py-3 px-4">Staff Count</th>
                                    <th class="text-left py-3 px-4">Total Amount</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="payrollTableBody">
                                <!-- Payroll entries will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Finance Module -->
                <div class="module-content p-6 hidden" id="financeModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Finance Management</h3>
                        <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center space-x-2" id="openAddInvoiceModalBtn" type="button">
                            <i class="fas fa-plus"></i>
                            <span>Add Invoice</span>
                        </button>
                    </div>
                    <div class="module-card p-6">
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchInvoiceNumber" placeholder="Search by Invoice #" type="text" name="searchInvoiceNumber"/>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchInvoiceStudent" placeholder="Search by Student Name" type="text" name="searchInvoiceStudent"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-600 w-full md:w-auto" id="applyInvoiceSearch" type="button">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Invoice #</th>
                                    <th class="text-left py-3 px-4">Student</th>
                                    <th class="text-left py-3 px-4">Class</th>
                                    <th class="text-left py-3 px-4">Father</th>
                                    <th class="text-left py-3 px-4">Total (₹)</th>
                                    <th class="text-left py-3 px-4">Paid (₹)</th>
                                    <th class="text-left py-3 px-4">Due (₹)</th>
                                    <th class="text-left py-3 px-4">Issued</th>
                                    <th class="text-left py-3 px-4">Due</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="financeTableBody">
                                <!-- Invoices will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Attendance Module -->
                <div class="module-content p-6 hidden" id="attendanceModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Attendance Management</h3>
                        <div class="flex space-x-2">
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-indigo-700" type="button" onclick="showAddAttendanceModal()">
                                <i class="fas fa-plus mr-2"></i>Mark Individual Attendance
                            </button>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="startQrAttendance()">
                                <i class="fas fa-qrcode mr-2"></i>Mark QR Attendance
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="exportStudentAttendanceToExcel()">
                                <i class="fas fa-file-excel mr-2"></i>Export to Excel
                            </button>
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-700" type="button" onclick="exportStudentAttendanceToPdf()">
                                <i class="fas fa-file-pdf mr-2"></i>Export to PDF
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <!-- QR Scanner Section (initially hidden) -->
                        <div id="qrScannerSection" class="hidden mb-6 p-4 border rounded-lg" style="background-color: var(--light); border-color: var(--border-color);">
                            <h4 class="text-lg font-medium" style="color: var(--dark);">Scan QR Code for Attendance</h4>
                            <div id="qrVideo" class="w-full h-64 rounded-lg" style="background-color: var(--gray-light);"></div>
                            <div class="mt-4 flex justify-end">
                                <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-600" onclick="stopQrAttendance()">Stop Scan</button>
                            </div>
                        </div>

                        <h4 class="text-lg font-medium" style="color: var(--dark);">Filter Student Attendance Records</h4>
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceStudentNameFilter" placeholder="Search by Student Name" type="text" name="attendanceStudentNameFilter"/>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceClassFilter" name="attendanceClassFilter">
                                <option value="">All Classes</option>
                                <option>Grade 1</option>
                                <option>Grade 2</option>
                                <option>Grade 3</option>
                                <option>Grade 4</option>
                                <option>Grade 5</option>
                                <option>Grade 6</option>
                                <option>Grade 7</option>
                                <option>Grade 8</option>
                                <option>Grade 9</option>
                                <option>Grade 10</option>
                                <option>Grade 11</option>
                                <option>Grade 12</option>
                            </select>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceDateFilter" type="date" name="attendanceDateFilter"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-indigo-600 w-full md:w-auto" id="applyAttendanceFilter" type="button">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Total Students</p>
                                <h4 class="text-xl font-bold" id="attendanceTotalStudents">0</h4>
                            </div>
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Present</p>
                                <h4 class="text-xl font-bold" style="color: var(--secondary);" id="attendanceTotalPresent">0</h4>
                            </div>
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Absent</p>
                                <h4 class="text-xl font-bold" style="color: var(--accent);" id="attendanceTotalAbsent">0</h4>
                            </div>
                        </div>

                        <h4 class="text-lg font-medium" style="color: var(--dark);">Class-wise Attendance Marking</h4>
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="classAttendanceSelect" name="classAttendanceSelect">
                                <option value="">Select Class</option>
                                <option>Grade 1</option>
                                <option>Grade 2</option>
                                <option>Grade 3</option>
                                <option>Grade 4</option>
                                <option>Grade 5</option>
                                <option>Grade 6</option>
                                <option>Grade 7</option>
                                <option>Grade 8</option>
                                <option>Grade 9</option>
                                <option>Grade 10</option>
                                <option>Grade 11</option>
                                <option>Grade 12</option>
                            </select>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="classAttendanceDate" type="date" name="classAttendanceDate"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-indigo-600 w-full md:w-auto" id="loadClassStudentsBtn" type="button">
                                <i class="fas fa-users mr-2"></i>Load Students
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-600 w-full md:w-auto" id="markAllPresentBtn" type="button">
                                <i class="fas fa-check-double mr-2"></i>Mark All Present
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Student Name</th>
                                    <th class="text-left py-3 px-4">Roll No.</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Remarks</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="classAttendanceTableBody">
                                <!-- Class-wise attendance records will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <h4 class="text-lg font-medium" style="color: var(--dark);">Student Attendance Records</h4>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Student Name</th>
                                    <th class="text-left py-3 px-4">Roll No.</th>
                                    <th class="text-left py-3 px-4">Class</th>
                                    <th class="text-left py-3 px-4">Date</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Arrival Time</th>
                                    <th class="text-left py-3 px-4">Departure Time</th>
                                    <th class="text-left py-3 px-4">Remarks</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="attendanceTableBody">
                                <!-- Student attendance records will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Teacher Attendance Module -->
                <div class="module-content p-6 hidden" id="teacher-attendanceModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Teacher Attendance Management</h3>
                        <div class="flex space-x-2">
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-700" type="button" onclick="showAddTeacherAttendanceModal()">
                                <i class="fas fa-plus mr-2"></i>Mark Teacher Attendance
                            </button>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="startTeacherQrAttendance('arrival')">
                                <i class="fas fa-qrcode mr-2"></i>Mark Arrival QR
                            </button>
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-orange-700" type="button" onclick="startTeacherQrAttendance('departure')">
                                <i class="fas fa-qrcode mr-2"></i>Mark Departure QR
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="exportTeacherAttendanceToExcel()">
                                <i class="fas fa-file-excel mr-2"></i>Export to Excel
                            </button>
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-700" type="button" onclick="exportTeacherAttendanceToPdf()">
                                <i class="fas fa-file-pdf mr-2"></i>Export to PDF
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <!-- QR Scanner Section for Teachers (initially hidden) -->
                        <div id="teacherQrScannerSection" class="hidden mb-6 p-4 border rounded-lg" style="background-color: var(--light); border-color: var(--border-color);">
                            <h4 class="text-lg font-medium" style="color: var(--dark);" id="teacherQrScannerTitle">Scan QR Code for Teacher Attendance</h4>
                            <div id="teacherQrVideo" class="w-full h-64 rounded-lg" style="background-color: var(--gray-light);"></div>
                            <div class="mt-4 flex justify-end">
                                <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-600" onclick="stopTeacherQrAttendance()">Stop Scan</button>
                            </div>
                        </div>
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Filter Teacher Attendance Records</h4>
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceNameFilter" placeholder="Search by Teacher Name" type="text" name="teacherAttendanceNameFilter"/>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceSubjectFilter" name="teacherAttendanceSubjectFilter">
                                <option value="">All Subjects</option>
                                <option>English</option>
                                <option>Hindi</option>
                                <option>Science</option>
                                <option>Math</option>
                                <option>Computer</option>
                                <option>Sanskrit</option>
                                <option>Social Study</option>
                                <option>Soil Science</option>
                            </select>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceDateFilter" type="date" name="teacherAttendanceDateFilter"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-600 w-full md:w-auto" id="applyTeacherAttendanceFilter" type="button">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Total Teachers</p>
                                <h4 class="text-xl font-bold" id="teacherAttendanceTotalTeachers">0</h4>
                            </div>
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Present</p>
                                <h4 class="text-xl font-bold" style="color: var(--secondary);" id="teacherAttendanceTotalPresent">0</h4>
                            </div>
                            <div class="module-card p-4 text-center">
                                <p style="color: var(--gray-medium);" class="text-sm">Absent</p>
                                <h4 class="text-xl font-bold" style="color: var(--accent);" id="teacherAttendanceTotalAbsent">0</h4>
                            </div>
                        </div>
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Teacher Attendance Records</h4>
                        <div class="overflow-x-auto">
                            <table class="min-w-full">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Teacher Name</th>
                                    <th class="text-left py-3 px-4">Subject</th>
                                    <th class="text-left py-3 px-4">Date</th>
                                    <th class="text-left py-3 px-4">Status</th>
                                    <th class="text-left py-3 px-4">Arrival Time</th>
                                    <th class="text-left py-3 px-4">Departure Time</th>
                                    <th class="text-left py-3 px-4">Remarks</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="teacherAttendanceTableBody">
                                <!-- Teacher attendance records will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Calendar Module -->
                <div class="module-content p-6 grid grid-cols-1 lg:grid-cols-3 gap-6 hidden" id="calendarModule">
                    <div class="lg:col-span-2 module-card p-6">
                        <h3 class="text-2xl font-semibold" style="color: var(--dark);">School Event Calendar</h3>
                        <div class="min-h-[500px]" id="calendar-full"></div>
                    </div>
                    <div class="lg:col-span-1 module-card p-6">
                        <h3 class="text-2xl font-semibold" style="color: var(--dark);">Upcoming Holidays</h3>
                        <div class="space-y-2" id="holidayList">
                            <!-- Holidays will be dynamically loaded here -->
                        </div>
                        <!-- NEW: Add Holiday Button -->
                        <button class="mt-4 px-4 py-2 rounded-lg" style="background-color: var(--primary); color: white;" onclick="showAddHolidayModal()">
                            <i class="fas fa-plus mr-2"></i>Add Holiday
                        </button>
                    </div>
                </div>
                <!-- Reports Module -->
                <div class="module-content p-6 hidden" id="reportsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Reports Dashboard</h3>
                        <div class="flex space-x-2">
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-700" type="button" onclick="exportReportsToPdf()">
                                <i class="fas fa-file-pdf mr-2"></i>Export to PDF
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="exportReportsToCsv()">
                                <i class="fas fa-file-csv mr-2"></i>Export to CSV
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6 mb-8">
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Generate Report</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="reportType">Report Type</label>
                                <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="reportType">
                                    <option value="">Select Report Type</option>
                                    <option value="student_performance">Student Performance Report</option>
                                    <option value="attendance_summary">Attendance Summary</option>
                                    <option value="financial_overview">Financial Overview</option>
                                    <option value="teacher_load">Teacher Load Report</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="reportClassFilter">Class (Optional)</label>
                                <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="reportClassFilter">
                                    <option value="">All Classes</option>
                                    <option>Grade 1</option>
                                    <option>Grade 2</option>
                                    <option>Grade 3</option>
                                    <option>Grade 4</option>
                                    <option>Grade 5</option>
                                    <option>Grade 6</option>
                                    <option>Grade 7</option>
                                    <option>Grade 8</option>
                                    <option>Grade 9</option>
                                    <option>Grade 10</option>
                                    <option>Grade 11</option>
                                    <option>Grade 12</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="reportStartDate">Start Date (Optional)</label>
                                <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="reportStartDate" type="date">
                            </div>
                            <div>
                                <label style="color: var(--gray-medium);" class="block text-sm font-medium mb-1" for="reportEndDate">End Date (Optional)</label>
                                <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="reportEndDate" type="date">
                            </div>
                        </div>
                        <div class="mt-4 text-right">
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-600" onclick="generateReport()">
                                <i class="fas fa-file-alt mr-2"></i>Generate Report
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <h4 class="font-medium mb-3">Generated Report</h4>
                        <div id="reportDisplayArea" class="min-h-[300px] p-4 rounded-lg overflow-auto" style="background-color: var(--gray-light); color: var(--dark);">
                            <p class="text-center" style="color: var(--gray-medium);">Select a report type and click "Generate Report" to view results here.</p>
                        </div>
                    </div>
                </div>
                <!-- Exams Module -->
                <div class="module-content p-6 hidden" id="examsModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Exams Management</h3>
                        <div class="flex space-x-2">
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="showAddExamModal()">
                                <i class="fas fa-plus mr-2"></i>Add New Exam
                            </button>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-purple-700" type="button" onclick="showGenerateResultsModal()">
                                <i class="fas fa-file-alt mr-2"></i>Generate Exam Results
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Exam List</h4>
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchExamName" placeholder="Search by Exam Name" type="text" name="searchExamName"/>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="searchExamClass" name="searchExamClass">
                                <option value="">All Classes</option>
                                <option>Grade 1</option>
                                <option>Grade 2</option>
                                <option>Grade 3</option>
                                <option>Grade 4</option>
                                <option>Grade 5</option>
                                <option>Grade 6</option>
                                <option>Grade 7</option>
                                <option>Grade 8</option>
                                <option>Grade 9</option>
                                <option>Grade 10</option>
                                <option>Grade 11</option>
                                <option>Grade 12</option>
                            </select>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-600 w-full md:w-auto" id="applyExamSearch" type="button">
                                <i class="fas fa-search mr-2"></i>Search
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full" id="examsTable">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">Exam Name</th>
                                    <th class="text-left py-3 px-4">Class</th>
                                    <th class="text-left py-3 px-4">Subject</th>
                                    <th class="text-left py-3 px-4">Date</th>
                                    <th class="text-left py-3 px-4">Max Marks</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="examTableBody">
                                <!-- Exam records will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- NEW: Homework Module -->
                <div class="module-content p-6 hidden" id="homeworkModule">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-semibold">Homework Management</h3>
                        <div class="flex space-x-2">
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" type="button" onclick="showAddHomeworkModal()">
                                <i class="fas fa-plus mr-2"></i>Add New Homework
                            </button>
                            <button style="background-color: var(--secondary); color: white;" class="px-4 py-2 rounded-lg hover:bg-green-700" type="button" onclick="exportHomeworkToExcel()">
                                <i class="fas fa-file-excel mr-2"></i>Export to Excel
                            </button>
                            <button style="background-color: var(--accent); color: white;" class="px-4 py-2 rounded-lg hover:bg-red-700" type="button" onclick="generateHomeworkReport()">
                                <i class="fas fa-file-pdf mr-2"></i>Generate Report
                            </button>
                        </div>
                    </div>
                    <div class="module-card p-6">
                        <h4 class="text-lg font-medium" style="color: var(--dark);">Filter Homework</h4>
                        <div class="flex flex-wrap items-center gap-4 mb-4">
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="filterHomeworkClass" name="filterHomeworkClass">
                                <option value="">All Classes</option>
                                <option>Grade 1</option>
                                <option>Grade 2</option>
                                <option>Grade 3</option>
                                <option>Grade 4</option>
                                <option>Grade 5</option>
                                <option>Grade 6</option>
                                <option>Grade 7</option>
                                <option>Grade 8</option>
                                <option>Grade 9</option>
                                <option>Grade 10</option>
                                <option>Grade 11</option>
                                <option>Grade 12</option>
                            </select>
                            <select class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="filterHomeworkSubject" name="filterHomeworkSubject">
                                <option value="">All Subjects</option>
                                <option>English</option>
                                <option>Hindi</option>
                                <option>Science</option>
                                <option>Math</option>
                                <option>Computer</option>
                                <option>Sanskrit</option>
                                <option>Social Study</option>
                                <option>Soil Science</option>
                            </select>
                            <input class="p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="filterHomeworkDueDate" type="date" name="filterHomeworkDueDate"/>
                            <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-600 w-full md:w-auto" id="applyHomeworkFilter" type="button" onclick="filterHomework()">
                                <i class="fas fa-filter mr-2"></i>Filter
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full" id="homeworkTable">
                                <thead>
                                <tr>
                                    <th class="text-left py-3 px-4">ID</th>
                                    <th class="text-left py-3 px-4">Title</th>
                                    <th class="text-left py-3 px-4">Class</th>
                                    <th class="text-left py-3 px-4">Subject</th>
                                    <th class="text-left py-3 px-4">Assigned Date</th>
                                    <th class="text-left py-3 px-4">Due Date</th>
                                    <th class="text-left py-3 px-4">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="homeworkTableBody">
                                <!-- Homework assignments will be dynamically loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- Generate Exam Results Modal -->
                <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="generateResultsModal" aria-labelledby="generateResultsModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                    <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold" id="generateResultsModalTitle">Generate Exam Results</h3>
                            <button class="text-gray-500 hover:text-gray-700" id="closeGenerateResultsModal" type="button" aria-label="Close generate results modal">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <form class="space-y-4" id="generateResultsForm">
                            <div>
                                <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="resultsClassFilter">Class</label>
                                <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="resultsClassFilter" required>
                                    <option value="">Select Class</option>
                                    <option>Grade 1</option><option>Grade 2</option><option>Grade 3</option><option>Grade 4</option><option>Grade 5</option><option>Grade 6</option><option>Grade 7</option><option>Grade 8</option><option>Grade 9</option><option>Grade 10</option><option>Grade 11</option><option>Grade 12</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="resultsExamTypeFilter">Exam Type</label>
                                <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="resultsExamTypeFilter" required>
                                    <option value="">Select Exam Type</option>
                                    <option>Mid-Term</option>
                                    <option>Final</option>
                                    <option>Unit Test</option>
                                </select>
                            </div>
                            <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" type="submit">
                                Generate PDF Report
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- View All Notifications Modal -->
            <div aria-labelledby="viewAllTitle" aria-modal="true" class="view-all-modal hidden" id="viewAllModal" role="dialog" tabindex="-1">
                <div class="view-all-content">
                    <div class="view-all-header">
                        <h3 id="viewAllTitle">All Notifications</h3>
                        <button aria-label="Close notifications modal" id="closeViewAllModal" type="button">×</button>
                    </div>
                    <div class="overflow-y-auto" id="viewAllNotificationList" style="max-height: 60vh;">
                        <!-- All notifications will be inserted here -->
                    </div>
                    <div class="view-all-footer">
                        <button id="modalMarkAllReadBtn" type="button">Mark all as read</button>
                    </div>
                </div>
            </div>
            <!-- Process Payroll Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="payrollModal" aria-labelledby="payrollModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="payrollModalTitle">Process Payroll</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closePayrollModalBtn" type="button" aria-label="Close payroll modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="payrollForm">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="payrollPeriod">Payroll Period</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="payrollPeriod" name="payrollPeriod" required="" type="month">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="staffCount">Staff Count</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="staffCount" min="1" name="staffCount" placeholder="Enter number of staff" required="" type="number">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="totalAmount">Total Amount (₹)</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="totalAmount" min="0" name="totalAmount" placeholder="Enter total payroll amount" required="" step="0.01" type="number">
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" type="submit">
                            Submit Payroll
                        </button>
                    </form>
                </div>
            </div>
            <!-- Add Invoice Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="addInvoiceModal" aria-labelledby="addInvoiceModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="addInvoiceModalTitle">Add New Invoice</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeAddInvoiceModalBtn" type="button" aria-label="Close add invoice modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="addInvoiceForm">
                        <input type="hidden" id="invoiceId" name="invoiceId">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceStudentId">Student</label>
                                <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="invoiceStudentId" required>
                                    <option value="">Select Student</option>
                                    <!-- Student options will be dynamically loaded here -->
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceNumber">Invoice #</label>
                                <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="invoiceNumber" placeholder="INV-001" required>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceTotalAmount">Total Amount (₹)</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoiceTotalAmount" min="0" name="invoiceTotalAmount" placeholder="e.g., 1500.00" required="" step="0.01" type="number">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoicePaidAmount">Paid Amount (₹)</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoicePaidAmount" min="0" name="invoicePaidAmount" placeholder="e.g., 1000.00" value="0.00" step="0.01" type="number">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceIssueDate">Issue Date</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoiceIssueDate" name="invoiceIssueDate" required="" type="date">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceDueDate">Due Date</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoiceDueDate" name="invoiceDueDate" required="" type="date">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoiceStatus" name="invoiceStatus" required="">
                                <option value="Paid">Paid</option>
                                <option value="Pending">Pending</option>
                                <option value="Overdue">Overdue</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="invoiceFormat">Invoice Format</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="invoiceFormat" name="invoiceFormat">
                                <option value="detailed">Detailed</option>
                                <option value="simplified">Simplified</option>
                                <option value="official">Official School Format</option>
                            </select>
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" type="submit" id="invoiceFormSubmitBtn">
                            Add Invoice
                        </button>
                    </form>
                </div>
            </div>
            <!-- Invoice Details Modal (for printing) -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="invoiceDetailsModal" aria-labelledby="invoiceDetailsModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-2xl shadow-lg print-area">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="invoiceDetailsModalTitle">Invoice Details</h3>
                        <button class="text-gray-500 hover:text-gray-700 print-hide" id="closeInvoiceDetailsModal" type="button" aria-label="Close invoice details modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div id="invoiceContent" class="space-y-4" style="color: var(--dark);">
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-bold">Tapowan Public School</h2>
                            <p class="text-sm" style="color: var(--gray-medium);">123 Education Lane, School City</p>
                            <p class="text-sm" style="color: var(--gray-medium);">info@tps.com | +1 (555) 123-4567</p>
                            <p class="text-sm font-medium">OFFICIAL INVOICE</p>
                        </div>

                        <div class="flex justify-between items-start mb-6">
                            <div class="w-1/2">
                                <p class="font-semibold">Invoice To:</p>
                                <p id="invoiceDetailStudentName" class="font-medium"></p>
                                <p id="invoiceDetailStudentClass"></p>
                                <p id="invoiceDetailFatherName"></p>
                                <p class="mt-2 font-semibold">Billing Date:</p>
                                <p id="invoiceDetailDate"></p>
                            </div>
                            <div class="text-right">
                                <p class="font-semibold">Invoice #<span id="invoiceDetailNumber" class="font-bold"></span></p>
                                <p>Due Date: <span id="invoiceDetailDueDate"></span></p>
                                <p class="mt-2">Status: <span id="invoiceDetailStatus" class="font-bold text-white px-2 py-1 rounded"></span></p>
                            </div>
                        </div>

                        <div class="border-t border-b" style="border-color: var(--border-color); padding-top: 1rem; padding-bottom: 1rem; margin-bottom: 1rem;">
                            <table class="w-full">
                                <thead>
                                    <tr class="border-b">
                                        <th class="text-left py-2 font-semibold">Description</th>
                                        <th class="text-right py-2 font-semibold">Amount (₹)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="py-2">Tuition Fees</td>
                                        <td class="text-right" id="invoiceDetailTotalAmount"></td>
                                    </tr>
                                    <tr>
                                        <td class="py-2">Amount Paid</td>
                                        <td class="text-right" style="color: var(--secondary);" id="invoiceDetailPaidAmount"></td>
                                    </tr>
                                    <tr class="border-t font-bold">
                                        <td class="py-2">Balance Due</td>
                                        <td class="text-right" style="color: var(--accent);" id="invoiceDetailDueAmount"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-end mb-4">
                            <div class="w-1/2 text-right">
                                <p class="flex justify-between"><span>Total:</span> <span id="invoiceDetailTotalAmountSummary" class="font-semibold"></span></p>
                                <p class="flex justify-between"><span>Paid:</span> <span id="invoiceDetailPaidAmountSummary" style="color: var(--secondary);" class="font-semibold"></span></p>
                                <p class="flex justify-between text-xl font-bold mt-2"><span>Due:</span> <span id="invoiceDetailDueAmountSummary" style="color: var(--accent);"></span></p>
                            </div>
                        </div>

                        <div class="text-center text-sm" style="color: var(--gray-medium); border-top: 1px solid var(--border-color); padding-top: 1rem;">
                            Thank you for your payment!
                        </div>
                    </div>
                    <div class="mt-6 text-right print-hide">
                        <button style="background-color: var(--primary); color: white;" class="px-4 py-2 rounded-lg hover:bg-blue-700" onclick="printInvoice()">
                            <i class="fas fa-print mr-2"></i>Print Invoice
                        </button>
                    </div>
                </div>
            </div>
            <!-- Add/Edit User Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="userModal" aria-labelledby="userModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="userModalTitle">Add New User</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeUserModal" type="button" aria-label="Close user modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="userForm">
                        <input id="userId" type="hidden" name="userId"/>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="userFullName">Full Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="userFullName" name="userFullName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="userEmail">Email</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="userEmail" name="userEmail" required="" type="email"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="userRole">Role</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="userRole" name="userRole" required="">
                                <option value="">Select Role</option>
                                <option>Admin</option>
                                <option>Teacher</option>
                                <option>Student</option>
                                <option>Staff</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="userPassword">Password</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="userPassword" name="userPassword" placeholder="Leave blank to keep current password" type="password"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="userStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="userStatus" name="userStatus" required="">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>
                        </div>
                        <button class="w-full py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="userFormSubmitBtn" type="submit">
                            Add User
                        </button>
                    </form>
                </div>
            </div>
            <!-- Add/Edit Announcement Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="announcementModal" aria-labelledby="announcementModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="announcementModalTitle">Add New Announcement</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeAnnouncementModal" type="button" aria-label="Close announcement modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="announcementForm">
                        <input id="announcementId" type="hidden" name="announcementId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="announcementTitle">Title</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="announcementTitle" name="announcementTitle" required="" type="text">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="announcementContent">Content</label>
                            <textarea class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="announcementContent" name="announcementContent" rows="4"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="announcementStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="announcementStatus" name="announcementStatus" required="">
                                <option value="Active">Active</option>
                                <option value="Archived">Archived</option>
                            </select>
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" id="announcementFormSubmitBtn" type="submit">
                            Publish Announcement
                        </button>
                    </form>
                </div>
            </div>
            <!-- Add/Edit Student Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="studentModal" aria-labelledby="studentModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="studentModalTitle">Add New Student</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeStudentModal" type="button" aria-label="Close student modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="studentForm">
                        <input id="studentId" type="hidden" name="studentId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentFullName">Full Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentFullName" name="studentFullName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentFatherName">Father's Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentFatherName" name="studentFatherName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentMotherName">Mother's Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentMotherName" name="studentMotherName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentClass">Class</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentClass" name="studentClass" required="">
                                <option value="">Select Class</option>
                                <option value="1">Grade 1</option>
                                <option value="2">Grade 2</option>
                                <option value="3">Grade 3</option>
                                <option value="4">Grade 4</option>
                                <option value="5">Grade 5</option>
                                <option value="6">Grade 6</option>
                                <option value="7">Grade 7</option>
                                <option value="8">Grade 8</option>
                                <option value="9">Grade 9</option>
                                <option value="10">Grade 10</option>
                                <option value="11">Grade 11</option>
                                <option value="12">Grade 12</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentRollNo">Roll No.</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentRollNo" name="studentRollNo" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentAadharNo">Aadhar No.</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentAadharNo" name="studentAadharNo" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentBloodGroup">Blood Group</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentBloodGroup" name="studentBloodGroup">
                                <option value="">Select Blood Group</option>
                                <option>A+</option>
                                <option>A-</option>
                                <option>B+</option>
                                <option>B-</option>
                                <option>AB+</option>
                                <option>AB-</option>
                                <option>O+</option>
                                <option>O-</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentAdmissionNo">Admission No.</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentAdmissionNo" name="studentAdmissionNo" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentAdmissionDate">Admission Date</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentAdmissionDate" name="studentAdmissionDate" type="date"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentFatherAadhar">Father's Aadhar</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentFatherAadhar" name="studentFatherAadhar" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentMotherAadhar">Mother's Aadhar</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentMotherAadhar" name="studentMotherAadhar" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentEmail">Email</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentEmail" name="studentEmail" type="email"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentPhone">Phone</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentPhone" name="studentPhone" type="tel"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="studentStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="studentStatus" name="studentStatus" required="">
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                            </select>
                        </div>
                        <button class="w-full py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="studentFormSubmitBtn" type="submit">
                            Add Student
                        </button>
                    </form>
                </div>
            </div>
            <!-- Student Details Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="studentDetailsModal" aria-labelledby="studentDetailsModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="studentDetailsModalTitle">Student Details</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeStudentDetailsModal" type="button" aria-label="Close student details modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="space-y-4" id="studentDetailsContent">
                        <!-- Student details will be dynamically loaded here -->
                    </div>
                </div>
            </div>
            <!-- Add/Edit Teacher Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="teacherModal" aria-labelledby="teacherModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="teacherModalTitle">Add New Teacher</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeTeacherModal" type="button" aria-label="Close teacher modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="teacherForm">
                        <input id="teacherId" type="hidden" name="teacherId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherFullName">Full Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="teacherFullName" name="teacherFullName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherSubject">Subject</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="teacherSubject" name="teacherSubject" required="">
                                <option value="">Select Subject</option>
                                <option>English</option>
                                <option>Hindi</option>
                                <option>Science</option>
                                <option>Math</option>
                                <option>Computer</option>
                                <option>Sanskrit</option>
                                <option>Social Study</option>
                                <option>Soil Science</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherEmail">Email</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="teacherEmail" name="teacherEmail" required="" type="email"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherClasses">Classes</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="teacherClasses" name="teacherClasses" placeholder="Grade 9-10" type="text"/>
                        </div>
                        <button class="w-full py-2 rounded-lg hover:bg-green-700" style="background-color: var(--secondary); color: white;" id="teacherFormSubmitBtn" type="submit">
                            Add Teacher
                        </button>
                    </form>
                </div>
            </div>
            <!-- Teacher Details Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="teacherDetailsModal" aria-labelledby="teacherDetailsModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="teacherDetailsModalTitle">Teacher Details</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeTeacherDetailsModal" type="button" aria-label="Close teacher details modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="space-y-4" id="teacherDetailsContent">
                        <!-- Teacher details will be dynamically loaded here -->
                    </div>
                </div>
            </div>
            <!-- Add/Edit Attendance Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="attendanceModal" aria-labelledby="attendanceModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="attendanceModalTitle">Mark Attendance</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeAttendanceModal" type="button" aria-label="Close attendance modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="attendanceForm">
                        <input id="attendanceId" type="hidden" name="attendanceId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="attendanceStudentSelect">Student Name</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceStudentSelect" name="attendanceStudentSelect" required="">
                                <option value="">Select Student</option>
                                <!-- Students will be dynamically loaded here -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="attendanceDate">Date</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceDate" name="attendanceDate" required="" type="date">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="attendanceStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceStatus" name="attendanceStatus" required="">
                                <option value="Present">Present</option>
                                <option value="Absent">Absent</option>
                                <option value="Leave">Leave</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="arrivalTime">Arrival Time</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="arrivalTime" name="arrivalTime" type="time">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="departureTime">Departure Time</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="departureTime" name="departureTime" type="time">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="attendanceRemarks">Remarks (Optional)</label>
                            <textarea class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="attendanceRemarks" name="attendanceRemarks" rows="2"></textarea>
                        </div>
                        <div class="flex flex-col space-y-2">
                            <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" id="registerStudentFingerprintBtn" type="button">
                                <i class="fas fa-fingerprint mr-2"></i>Register Fingerprint
                            </button>
                            <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--secondary); color: white;" id="verifyStudentFingerprintBtn" type="button">
                                <i class="fas fa-fingerprint mr-2"></i>Verify Fingerprint (Mark Present)
                            </button>
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" id="attendanceFormSubmitBtn" type="submit">
                            Mark Attendance
                        </button>
                    </form>
                </div>
            </div>
            <!-- Add/Edit Teacher Attendance Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="teacherAttendanceModal" aria-labelledby="teacherAttendanceModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="teacherAttendanceModalTitle">Mark Teacher Attendance</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeTeacherAttendanceModal" type="button" aria-label="Close teacher attendance modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="teacherAttendanceForm">
                        <input id="teacherAttendanceId" type="hidden" name="teacherAttendanceId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherAttendanceTeacherSelect">Teacher Name</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceTeacherSelect" name="teacherAttendanceTeacherSelect" required="">
                                <option value="">Select Teacher</option>
                                <!-- Teachers will be dynamically loaded here -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherAttendanceDate">Date</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceDate" name="teacherAttendanceDate" required="" type="date">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherAttendanceStatus">Status</label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceStatus" name="teacherAttendanceStatus" required="">
                                <option value="Present">Present</option>
                                <option value="Absent">Absent</option>
                                <option value="Leave">Leave</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherArrivalTime">Arrival Time</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherArrivalTime" name="teacherArrivalTime" type="time">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherDepartureTime">Departure Time</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherDepartureTime" name="teacherDepartureTime" type="time">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="teacherAttendanceRemarks">Remarks (Optional)</label>
                            <textarea class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="teacherAttendanceRemarks" name="teacherAttendanceRemarks" rows="2"></textarea>
                        </div>
                        <div class="flex flex-col space-y-2">
                            <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" id="registerTeacherFingerprintBtn" type="button">
                                <i class="fas fa-fingerprint mr-2"></i>Register Fingerprint
                            </button>
                            <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--secondary); color: white;" id="verifyTeacherFingerprintBtn" type="button">
                                <i class="fas fa-fingerprint mr-2"></i>Verify Fingerprint (Mark Present)
                            </button>
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" id="teacherAttendanceFormSubmitBtn" type="submit">
                            Mark Attendance
                        </button>
                    </form>
                </div>
            </div>
            <!-- Add/Edit Exam Modal -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="examModal" aria-labelledby="examModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="examModalTitle">Add New Exam</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeExamModal" type="button" aria-label="Close exam modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="examForm">
                        <input id="examId" type="hidden" name="examId">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="examName">Exam Name</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="examName" name="examName" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="examClass">Class</label>
                            <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="examClass" name="examClass" required="">
                                <option value="">Select Class</option>
                                <option>Grade 1</option>
                                <option>Grade 2</option>
                                <option>Grade 3</option>
                                <option>Grade 4</option>
                                <option>Grade 5</option>
                                <option>Grade 6</option>
                                <option>Grade 7</option>
                                <option>Grade 8</option>
                                <option>Grade 9</option>
                                <option>Grade 10</option>
                                <option>Grade 11</option>
                                <option>Grade 12</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="examSubject">Subject</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="examSubject" name="examSubject" required="" type="text"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="examDate">Date</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="examDate" name="examDate" required="" type="date"/>
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="examMaxMarks">Max Marks</label>
                            <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="examMaxMarks" name="examMaxMarks" required="" type="number" min="0"/>
                        </div>
                        <button class="w-full py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="examFormSubmitBtn" type="submit">
                            Save Exam
                        </button>
                    </form>
                </div>
            </div>

            <!-- NEW: Add Holiday Modal Structure -->
            <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="addHolidayModal" aria-labelledby="addHolidayModalTitle" aria-modal="true" role="dialog" tabindex="-1">
                <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold" id="addHolidayModalTitle">Add New Holiday</h3>
                        <button class="text-gray-500 hover:text-gray-700" id="closeAddHolidayModal" type="button" aria-label="Close add holiday modal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form class="space-y-4" id="addHolidayForm">
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="holidayName">Holiday Name</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="holidayName" name="holidayName" required="" type="text">
                        </div>
                        <div>
                            <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="holidayDate">Date</label>
                            <input class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2" style="border-color: var(--border-color); focus-ring-color: var(--primary);" id="holidayDate" name="holidayDate" required="" type="date">
                        </div>
                        <button class="w-full py-2 rounded-lg font-semibold" style="background-color: var(--primary); color: white;" type="submit">
                            Add Holiday
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Student QR Code Modal -->
    <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="studentQrCodeModal" aria-labelledby="studentQrCodeModalTitle" aria-modal="true" role="dialog" tabindex="-1">
        <div class="bg-white rounded-lg p-6 w-full max-w-sm shadow-lg text-center">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold" id="studentQrCodeModalTitle">Student QR Code</h3>
                <button class="text-gray-500 hover:text-gray-700" id="closeStudentQrCodeModal" type="button" aria-label="Close QR code modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <canvas id="studentQrCodeCanvas" width="200" height="200" class="mx-auto border p-2 rounded-lg" style="border-color: var(--border-color);"></canvas>
                <p class="mt-4" style="color: var(--dark);">Scan this QR code for attendance.</p>
                <p class="text-sm" style="color: var(--gray-medium);" id="qrCodeStudentIdDisplay"></p>
            </div>
            <div class="mt-6 flex justify-center space-x-4">
                <button class="px-4 py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="printQrCodeBtn" onclick="printStudentQrCode()">
                    <i class="fas fa-print mr-2"></i>Print
                </button>
                <a id="downloadQrCodeLink" download="student_qr_code.png" class="px-4 py-2 rounded-lg hover:bg-green-700 inline-flex items-center" style="background-color: var(--secondary); color: white;">
                    <i class="fas fa-download mr-2"></i>Download
                </a>
            </div>
        </div>
    </div>

    <!-- NEW: Add/Edit Homework Modal -->
    <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="addHomeworkModal" aria-labelledby="addHomeworkModalTitle" aria-modal="true" role="dialog" tabindex="-1">
        <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold" id="addHomeworkModalTitle">Add New Homework</h3>
                <button class="text-gray-500 hover:text-gray-700" id="closeAddHomeworkModal" type="button" aria-label="Close add homework modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="space-y-4" id="homeworkForm">
                <input type="hidden" id="homeworkId" name="homeworkId">
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkTitle">Title</label>
                    <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkTitle" name="homeworkTitle" required="" type="text"/>
                </div>
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkClass">Class</label>
                    <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkClass" name="homeworkClass" required="">
                        <option value="">Select Class</option>
                        <option>Grade 1</option>
                        <option>Grade 2</option>
                        <option>Grade 3</option>
                        <option>Grade 4</option>
                        <option>Grade 5</option>
                        <option>Grade 6</option>
                        <option>Grade 7</option>
                        <option>Grade 8</option>
                        <option>Grade 9</option>
                        <option>Grade 10</option>
                        <option>Grade 11</option>
                        <option>Grade 12</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkSubject">Subject</label>
                    <select class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkSubject" name="homeworkSubject" required="">
                        <option value="">Select Subject</option>
                        <option>English</option>
                        <option>Hindi</option>
                        <option>Science</option>
                        <option>Math</option>
                        <option>Computer</option>
                        <option>Sanskrit</option>
                        <option>Social Study</option>
                        <option>Soil Science</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkAssignedDate">Assigned Date</label>
                    <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkAssignedDate" name="homeworkAssignedDate" required="" type="date"/>
                </div>
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkDueDate">Due Date</label>
                    <input class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkDueDate" name="homeworkDueDate" required="" type="date"/>
                </div>
                <div>
                    <label class="block text-sm font-medium" style="color: var(--gray-medium);" for="homeworkDescription">Description</label>
                    <textarea class="w-full p-2 border rounded-lg" style="border-color: var(--border-color);" id="homeworkDescription" name="homeworkDescription" rows="4"></textarea>
                </div>
                <button class="w-full py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="homeworkFormSubmitBtn" type="submit">
                    Add Homework
                </button>
            </form>
        </div>
    </div>

    <!-- NEW: Homework Details Modal -->
    <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="homeworkDetailsModal" aria-labelledby="homeworkDetailsModalTitle" aria-modal="true" role="dialog" tabindex="-1">
        <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold" id="homeworkDetailsModalTitle">Homework Details</h3>
                <button class="text-gray-500 hover:text-gray-700" id="closeHomeworkDetailsModal" type="button" aria-label="Close homework details modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4" id="homeworkDetailsContent">
                <!-- Homework details will be dynamically loaded here -->
            </div>
        </div>
    </div>

    <!-- NEW: Teacher QR Code Modal -->
    <div class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="teacherQrCodeModal" aria-labelledby="teacherQrCodeModalTitle" aria-modal="true" role="dialog" tabindex="-1">
        <div class="bg-white rounded-lg p-6 w-full max-w-sm shadow-lg text-center">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold" id="teacherQrCodeModalTitle">Teacher QR Code</h3>
                <button class="text-gray-500 hover:text-gray-700" id="closeTeacherQrCodeModal" type="button" aria-label="Close QR code modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="p-4">
                <canvas id="teacherQrCodeCanvas" width="200" height="200" class="mx-auto border p-2 rounded-lg" style="border-color: var(--border-color);"></canvas>
                <p class="mt-4" style="color: var(--dark);">Scan this QR code for attendance.</p>
                <p class="text-sm" style="color: var(--gray-medium);" id="qrCodeTeacherIdDisplay"></p>
            </div>
            <div class="mt-6 flex justify-center space-x-4">
                <button class="px-4 py-2 rounded-lg hover:bg-blue-700" style="background-color: var(--primary); color: white;" id="printTeacherQrCodeBtn" onclick="printTeacherQrCode()">
                    <i class="fas fa-print mr-2"></i>Print
                </button>
                <a id="downloadTeacherQrCodeLink" download="teacher_qr_code.png" class="px-4 py-2 rounded-lg hover:bg-green-700 inline-flex items-center" style="background-color: var(--secondary); color: white;">
                    <i class="fas fa-download mr-2"></i>Download
                </a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.16/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
